# Java_Concurrency

Проекты по параллельному программированию, выполненные в среде Intellij IDEA. 
Перед запуском необходим установленный JDK x64 последней версии. Скачать для ОС Windows можно по ссылке https://download.oracle.com/java/17/latest/jdk-17_windows-x64_bin.msi
После установки JDK запустить файл Start_ProducersConsumers.bat и Start_ThreadPool.bat
Скомпилированные JAR файлы находятся в директории \project_%NAME%\out\artifacts\project_%NAME%_jar

project_ProducersConsumers - решение упрощённой задачи «производитель-потребитель».
В процессе исполнения программы, потоки типа "производитель" (Producer) создают последовательно, с паузой 0.5сек., 2 случайных числа rand_var, и кладут в хранилище типа Store, во время чего потоки типа "потребитель" (Consumer) эти числа из хранилища извлекают.
Если на момент извлечения потребителем хранилище пустое, потребителю передается максимальное число Integer.MAX_VALUE, по которому он регистрирует остутствие чисел в хранилище.
Выполнение задачи происходит в параллельном режиме, хранилище как ресурс защищено от взаимных блокировок с помощью мьютексов. 
Завершение программы в процессе её выполнения осуществляется нажатием клавиши Enter.
В процессе завершения программы, из метода main() каждому потоку последовательно передаётся команда о завершении interrupt().
По окончанию завершения всех потоков в строке вывода выводится сообщение "All threads is closed.".

project_ThreadPool - реализация паттерна «пул потоков».
Класс ThreadPool реализуется как объект threadPool, который при инициализации принимает число потоков, затем создаёт и запускает пул параллельно работающих потоков. Логика работы потоков описывается в подклассе TaskWorker класса ThreadPool. Пул способен последовательно принимать задачи во внутреннюю очередь tasks_queue и распределять их по свободным потокам.
Класс очереди задач TasksQueue описывается как неразделимый потокобезопасный ресурс, доступ к которому в определенный момент времени имеет только один поток.
Класс задач Tasks описывает вычисление тангенса в 15000000 итерациях и суммирование с предыдущим вычисленным значением из каждой итерации. Параметром для тангенса является порядковый номер задачи.
Число потоков max_threads_num и число задач tasks_num задаются константами в методе main() класса Main. Также из метода main() запускается инициализация списка задач task_list, инициализация тредпула и последовательная передача в него задач со случайной задержкой в интервале от 100 до 500 мс. Если число потоков меньше 1, то тредрул не проинициализируется и выдаст на экран в строке вывода количество заданных потоков и что их число должно быть больше 0.
При запуске потока, извлечение задачи из очереди tasks_queue происходит автоматически. Если задачи для потока нет (очередь пуста), то поток ожидает её поступление у барьера new_task_notify. Если во время поступления задачи в в тредпул все потоки заняты, то первый освободившийся из них сам забирает первую поступившую в очередь задачу.
В момент извлечения задачи, поток выводит на экран в строке вывода свой номер и уведомление о принятии задачи, понижает счётчик свободных потоков и начинает выполнение задачи.
После выполнения задачи поток выдаёт результат на экран в строке вывода и повышает счётчик свободных потоков.
Когда метод main() завершит передачу задач, он заканчивает своё выполнение и в threadPool автоматически запускается процедура завершения close(), при этом threadPool уже больше не будет принимать новые задачи.
Во время исполнения close(), главный поток Main ставит флаг is_closed в true и ожидает сообщения от последнего потока у барьера close_notify. Последний работающий поток после выполнения задачи разблокирует Main и тот перейдёт к последовательному закрытию всех потоков. В процессе закрытия, каждый поток выводит на экран в строке вывода сообщение о закрытии со своим номером.
Когда все потоки закрыты, на экране в строке вывода выводится сообщение о завершении выполнения задач и время обработки всех задач в секундах.